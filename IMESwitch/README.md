# IMESwitch - IME切り替えツール

AutoHotkey v2用のIME（Input Method Editor）切り替えスクリプトです。日本語IMEと中国語IME間の切り替え、および各IME内での言語モード切り替えを効率的に行えます。

## 機能

- 日本語IMEと中国語IME間の素早い切り替え
- 各IME内での日本語/英語、中国語/英語の切り替え
- キーボードの特定キーによる直感的な操作
- UWPアプリケーションへの対応
- ログ機能とデバッグ機能
- ツールチップによる視覚的フィードバック

## キーバインド

| キー | 機能 |
|------|------|
| 変換（Henkan） | 日本語IMEへ切り替え／日本語⇔英語モード切り替え |
| 無変換（Muhenkan） | 中国語IMEへ切り替え／中国語⇔英語モード切り替え |
| カナ（Kana） | 現在のIMEの言語切り替え |

## 必要な設定

### 日本語IME設定
- **Ctrl + F12**: IME ON
- **Ctrl + Alt + F12**: IME OFF
- **F7**: IME ON/OFF切り替え

### 中国語IME設定
- **Ctrl + Space**: 中国語⇔英語切り替え

## 使用方法

1. 必要な設定を各IMEで行う
2. `ime_switch.ahk`を実行する
3. 変換キーで日本語IME、無変換キーで中国語IMEに切り替える
4. 同じキーを再度押すと、そのIME内での言語モードが切り替わる
5. 切り替えが成功すると、画面右下にツールチップで現在の言語が表示されます

## ファイル構成

```
IMESwitch/
├── ime_switch.ahk      # メインスクリプト
├── ime_switch.log      # ログファイル（デバッグ時）
├── IMEv2.ahk/          # IME制御ライブラリ（サブモジュール）
│   ├── IMEv2.ahk       # IME制御関数
│   ├── README.md       # ライブラリ説明
│   └── testIMEv2.ahk   # テストコード
└── README.md           # このファイル
```

## 依存関係

- [IMEv2.ahk](https://github.com/k-ayaki/IMEv2.ahk) - AutoHotkey v2用のIME制御ライブラリ

## 設定オプション

スクリプト内で以下の設定を変更できます：

- `logging`: ログ出力の有効/無効（デフォルト: false）
- `debugging_tooltip`: デバッグ用ツールチップの有効/無効（デフォルト: false）

## ツールチップ表示

本スクリプトでは、操作の確認や状態表示のためにツールチップが表示されます：

### 言語切り替え時のツールチップ
- **"ja"**: 日本語IMEに切り替わった時
- **"zh_cn"**: 中国語IMEに切り替わった時  
- **"en"**: 英語モードに切り替わった時

### デバッグ用ツールチップ
`debugging_tooltip`を`true`に設定すると、以下の詳細情報が表示されます：
- 現在のIME言語コード（HKL）
- 変換モード（Conversion Mode）
- IME状態（ON/OFF）

### エラー通知ツールチップ
- 設定されていない言語への切り替え試行時
- IME制御に失敗した場合

**表示時間**: ツールチップは2秒後に自動的に消えます
**UWP APP**: UWPアプリケーションではツールチップが表示されない場合があります

## 対応環境

- AutoHotkey v2.0以降
- Microsoft IME（日本語、中国語）
- UWPアプリケーション対応（API制限によって、現在のIME状態をうまく認識できない場合があります）

## 注意事項

- 初回使用時は各IMEで指定されたホットキーを設定する必要があります
- UWPアプリケーションでは一部制限がある場合があります
- ログファイルは同ディレクトリに`ime_switch.log`として出力されます

## トラブルシューティング

- IMEが正しく切り替わらない場合は、各IMEのホットキー設定を確認してください
- UWPアプリで動作しない場合があります
- デバッグが必要な場合は、`logging`と`debugging_tooltip`を`true`に設定してください
  